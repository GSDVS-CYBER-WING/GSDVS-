# 13.1 简介与趋势

系统的设计和运维过去一直以来都依靠工程师的经验和试错。在系统的规模和复杂度较小时，工程师可以经由大量的实验来评估系统的性能以及理解系统的行为。工程师从这些实验里获得的经验，并手写成系统里的启发式算法和决策规则。另外，这些经验不仅能帮助工程师来优化现有的系统，也能帮助他们设计未来的系统。

然而现代系统的复杂性和规模快速提升，为这种依赖人力和经验的方式带来了前所未有的挑战。首先，人力的增长赶不上系统规模和动态性上升的速度。我们这边用微服务的现代系统来当作是一个例子。微服务的的架构强调模块化 --- 一个系统由多个模块组成，而模块的实现就基于像 Docker 的容器技术和 Hypervisor 的虚拟技术。模块化使得现代系统能够很好地支持横纵向扩展和独立更新，尤其是在像 Kubernetes 的自动集群管理下。随着时间，用户的需求和场景有了改变，模块的数量和模块之间的交互也能做出相对应的变化来保证系统的服务品质。然而，每一次的变化都代表着工程师需要重新理解系统的行为来优化和维护系统。但是，人的理解力难以理解系统的行为是如何被每一个设定参数和决策所影响 --- 每一系统模块有着不同的设定参数和决策，然后模块和模块之间有着不同的依赖关系。例如系统里常用的数据库有着上百个设定参数，和像数据索引的决策。另外，操作系统里有调度策略，分布系统里有资源的分配策略，微服务有扩容策略，网路的 TCP 有 congestion control 和 flow control 的设定参数，视频流应用有网路品质的评估策略，防火墙有规则匹配策略，处理器里有缓存置换和预存取算法，甚至代码编译器也有设定参数。

在近几年，学习增强系统的范式转移已成为系统设计的趋势。系统的性能和行为与决策和参数的关系可以被想象成一个非线性的空间，而学习增强系统的范式就是在这空间里学习并搜索全局最优解。这空间可能很复杂，但现代系统普遍有完善的行为监测机制和精细的日志，加上近期机器学习的进步（例如深度学习和强化学习），大大提升了数据驱动的可行性。

学习增强系统普遍有 3 种实现的方式。第一种是用机器学习来辅助现有的启发式算法和决策规则；第二种是用机器学习来取代现有的启发式算法和决策规则；第三种是用机器学习来改进和设计启发式算法和决策规则。不同的实现方式有着不同的折衷与取舍，尤其是在以下的维度：系统所需要的决策准确率，系统所分配的模型训练开销，系统所能容忍的模型推理时间与资源开销。比如，虽然用机器学习来取代手写的启发式算法可以大大地利用机器学习在优化问题上的能力，但机器学习有着不可忽视的时间与资源开销。之后在这章节里，我们将从我们过去的科研和产品经验里，来总结这些折衷与取舍为机器学习所带来新的挑战。
